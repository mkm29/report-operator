package v1alpha1

import "github.com/ulule/deepcopier"

// VulnerabilityReport is the struct that holds the data for the vulnerability report

// transform method on VulnerabilityReport transforms the VulnerabilityReport into a JSON file
// snyk format: see resources/snyk.json for reference
func (r *VulnerabilityReport) Transform() (SnykReport, error) {
	// create a new JSON file
	// write the VulnerabilityReport data into the JSON file
	// return the JSON file
	// 1. Convert Vulnerabilities to SnykVulnerabilities
	snykVulnerabilities := make([]SnykVulnerability, len(r.Report.Vulnerabilities))
	for i, v := range r.Report.Vulnerabilities {
		sv := &SnykVulnerability{}
		deepcopier.Copy(v).To(sv)
		snykVulnerabilities[i] = *sv
	}
	// 2. create SnykReport struct
	snykReport := SnykReport{
		Vulnerabilities: snykVulnerabilities,
	}
	return snykReport, nil
}
